version: 2
jobs:
	build:
		docker:
			- image: circleci/node:7.10
			working_directory: ~/repo
			steps:
				- checkout

				- restore_cache:
					keys:
						- v1-dependencies-{{ checksum "package.json" }}
						- v1-dependencies-

						- run: npm install

						- save_cache:
							paths:
								- node_modules
								key: v1-dependencies-{{ checksum "package.json" }}
				- run: sudo npm install -g pkg
				- run: mkdir build && cd build
				- run: pkg ../package.json
				- run: pkg ../setup.js
				- run: mv ./* $CIRCLE_ARTIFACTS/
